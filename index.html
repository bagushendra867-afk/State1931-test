<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>STATE 1931 â€” Whiteout Survival</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
<style>
:root{ --bg1:#071026; --bg2:#0f2a44; --glass: rgba(255,255,255,0.06); --glass-2: rgba(255,255,255,0.04); --accent:#58a6ff; --neon:#66d0ff; --muted:#bfcfe0; }
*{box-sizing:border-box}
html,body{height:100%;margin:0;font-family:Inter,system-ui,sans-serif;overflow-x:hidden;}
body{ background: linear-gradient(135deg,var(--bg1), var(--bg2)); color:#eaf5ff;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale; }
#snow-canvas{position:fixed;left:0;top:0;width:100%;height:100%;pointer-events:none;z-index:0;mix-blend-mode:screen;opacity:0.9}
.wrap{position:relative;z-index:1;max-width:980px;margin:16px auto;padding:14px; padding-bottom: 150px;}

/* Header & Grid Style */
header.appbar{ display:flex;flex-wrap:wrap;gap:12px;align-items:center; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); padding:14px;border-radius:14px; box-shadow:0 6px 18px rgba(3,10,20,0.6), inset 0 -1px 0 rgba(255,255,255,0.02); backdrop-filter: blur(8px) saturate(120%); }
.logo{ width:54px;height:54px;border-radius:10px; background:linear-gradient(180deg,#0f3a6b,#06304f); display:flex;align-items:center;justify-content:center;font-weight:800; box-shadow:0 6px 20px rgba(0,0,0,0.5); border:1px solid rgba(255,255,255,0.04); color:var(--neon); font-size:18px; }
.title-block h1{margin:0;font-size:20px;font-weight:800;line-height:1.2} .title-block p{margin:0;font-size:12px;color:var(--muted)} header .right{margin-left:auto;text-align:right;font-size:13px;color:var(--muted)}
.countdown{display:flex;gap:6px;align-items:center;font-weight:700} .countdown .box{background:rgba(0,0,0,0.18);padding:6px 10px;border-radius:8px;min-width:44px;text-align:center}
.grid{display:grid;grid-template-columns:1fr;gap:12px;margin-top:14px;} @media(min-width:880px){.grid{grid-template-columns:360px 1fr;}}
.card{ background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02)); border-radius:12px;padding:12px; box-shadow: 0 8px 24px rgba(2,8,20,0.6); border:1px solid rgba(255,255,255,0.04); backdrop-filter: blur(10px) saturate(120%); }
.alliances-list{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:6px} .alliance{ padding:10px;border-radius:10px;text-align:center;font-weight:700; transition:transform .18s, box-shadow .18s; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border:1px solid rgba(255,255,255,0.02); font-size:14px; }
.alliance:hover{transform:translateY(-4px);box-shadow:0 8px 24px rgba(0,0,0,0.5)} .kor{color:#3bb0ff} .grd{color:#2de68c} .bee{color:#fff24f} .tur{color:#ff5c5c}
.btn{ display:inline-block;padding:10px 14px;border-radius:10px;text-decoration:none;font-weight:700; background:linear-gradient(90deg,var(--accent),#3bd1ff); color:#021428;border:none;cursor:pointer; box-shadow:0 6px 20px rgba(60,140,220,0.12), 0 0 18px rgba(60,160,255,0.06); transition:transform .12s, box-shadow .12s; } .btn:active{transform:translateY(1px)} .btn.neon{ color:#001425;background:linear-gradient(90deg,#004b68,#00c0ff); box-shadow:0 6px 28px rgba(0,190,255,0.14),0 0 30px rgba(102,208,255,0.12); } .btn.sm{padding:6px 10px;font-size:12px}
.actions{display:flex;gap:10px;flex-wrap:wrap;justify-content:flex-start;align-items:center} .actions .btn { flex: 1; text-align: center; }
.accordion{width:100%;background:var(--glass-2);padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);cursor:pointer;display:flex;justify-content:space-between;align-items:center;margin-top:6px} .accordion .left{display:flex;gap:10px;align-items:center} .accordion .alias{font-weight:800;font-size:15px} .chev{transition:transform .2s} .panel{display:none;padding:10px;margin-top:6px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:8px;border:1px solid rgba(255,255,255,0.02)} .event-row{display:flex;justify-content:space-between;padding:6px 8px;border-radius:8px;margin:4px 0;background:rgba(0,0,0,0.12)} .event-name{font-weight:600;font-size:14px} .event-time{font-weight:700}
#kor-panel .event-name, #kor-panel .event-time { color: #3bb0ff; } #grd-panel .event-name, #grd-panel .event-time { color: #2de68c; } #bee-panel .event-name, #bee-panel .event-time { color: #fff24f; } #tur-panel .event-name, #tur-panel .event-time { color: #ff5c5c; }
.caption{font-size:12px;color:var(--muted);margin-top:6px} .fadeIn{opacity:0;transform:translateY(6px);animation:fadeUp .6s forwards} .fadeIn.delay1{animation-delay:.08s}.fadeIn.delay2{animation-delay:.16s}.fadeIn.delay3{animation-delay:.24s}.fadeIn.delay4{animation-delay:.32s} @keyframes fadeUp{to{opacity:1;transform:none}} .lang-switch{display:flex;gap:6px;justify-content:flex-end;margin-bottom:6px}

/* ========================================= */
/* STYLE KADO FINAL (POSISI POJOK BAWAH)     */
/* ========================================= */
.gift-widget-container {
    position: fixed;
    z-index: 10000;
    
    /* POSISI DI HP: POJOK KANAN BAWAH */
    bottom: 20px; 
    right: 20px;
    top: auto; 
    
    transform: scale(0.45); 
    transform-origin: bottom right; 
    transition: all 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

/* KHUSUS DESKTOP: TENGAH KANAN */
@media (min-width: 768px) {
    .gift-widget-container {
        top: 50%;
        bottom: auto;
        right: 30px; 
        transform: translateY(-50%) scale(0.7); 
        transform-origin: center right;
    }
}

/* SAAT DIKLIK (ACTIVE): PINDAH TENGAH LAYAR */
.gift-widget-container.active {
    top: 50% !important; 
    left: 50% !important; 
    right: auto; bottom: auto;
    
    transform: translate(-50%, -50%) scale(1); 
    transform-origin: center center;
}

/* Style Kotak Premium */
.gift-box {
    position: relative; width: 150px; height: 120px;
    background: linear-gradient(135deg, #d32f2f, #ef5350);
    border-radius: 8px; cursor: pointer; z-index: 10;
    box-shadow: 0 0 20px rgba(255, 50, 50, 0.4);
}
.gift-box::before { 
    content: ''; position: absolute; width: 25px; height: 100%;
    background: linear-gradient(to right, #ffd700, #fdb931);
    left: 50%; transform: translateX(-50%); box-shadow: 0 0 5px rgba(0,0,0,0.2);
}
.lid {
    position: absolute; width: 170px; height: 40px;
    background: linear-gradient(135deg, #b71c1c, #d32f2f);
    top: -40px; left: -10px; border-radius: 5px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.3); z-index: 20;
    transition: transform 0.5s ease-in-out, top 0.5s ease-in-out, opacity 0.3s;
}
.lid::before { 
    content: ''; position: absolute; width: 25px; height: 100%;
    background: linear-gradient(to right, #ffd700, #fdb931);
    left: 50%; transform: translateX(-50%);
}
.lid::after { 
    content: ''; position: absolute; width: 100%; height: 25px;
    background: linear-gradient(to bottom, #ffd700, #fdb931);
    top: 50%; transform: translateY(-50%);
}
.bow {
    position: absolute; top: -30px; left: 50%; transform: translateX(-50%);
    width: 60px; height: 30px; z-index: 25;
    transition: opacity 0.3s;
}
.bow::before, .bow::after {
    content: ''; position: absolute; top: 0; width: 30px; height: 30px;
    background: radial-gradient(circle at center, #ffd700 30%, #fdb931 100%);
    border-radius: 50% 50% 0 50%; 
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
}
.bow::before { left: 0; transform: rotate(30deg); }
.bow::after { right: 0; transform: rotate(-30deg) scaleX(-1); }

.gift-box:not(.open):hover { animation: bounce 1s infinite; }
@keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }

/* SURAT */
.letter {
    position: absolute; width: 280px; padding: 25px; 
    background: #fff; border: 4px double #d32f2f; border-radius: 10px;
    top: 10px; 
    left: 50%; transform: translateX(-50%) scale(0.5);
    opacity: 0; z-index: 5; transition: all 0.8s ease-in-out;
    box-shadow: 0 10px 30px rgba(0,0,0,0.5); font-family: 'Dancing Script', cursive;
}
.letter h2 { margin: 0 0 15px; color: #b71c1c; text-align: center; font-size: 2rem; font-weight: 700; text-shadow: 1px 1px 0px rgba(0,0,0,0.1); }
.letter p { font-size: 1.4rem; color: #333; line-height: 1.5; margin: 0; font-weight: 600; }

/* --- PERBAIKAN: SURAT DITURUNKAN --- */
.open .lid, .open .bow { 
    top: -200px; transform: rotate(-20deg); opacity: 0; 
}
.open .letter { 
    /* UBAH JADI -220px (Tadinya -280px ketinggian) */
    top: -220px; 
    opacity: 1; 
    transform: translateX(-50%) scale(1); 
    z-index: 50; 
}

@media (max-width: 480px) {
    .letter { width: 90vw; max-width: 300px; }
}
</style>
</head>
<body>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<canvas id="snow-canvas"></canvas>
<div class="wrap">
<header class="appbar fadeIn">
  <div class="logo">
    <img src="logo-baru.png" alt="STATE 1931" style="width:100%; height:100%; object-fit:contain; border-radius:10px;">
  </div>
  <div class="title-block">
    <h1>âœ¨ STATE 1931</h1>
    <p data-i18n="subtitle">Whiteout Survival â€” info & schedule (UTC)</p>
  </div>
  <div class="right">
  <div class="lang-switch">
    <button class="btn sm" data-lang="id">ğŸ‡®ğŸ‡©</button>
    <button class="btn sm" data-lang="en">ğŸ‡ºğŸ‡¸</button>
    <button class="btn sm" data-lang="ko">ğŸ‡°ğŸ‡·</button>
  </div>
  <div data-i18n="nextLabel">Next event</div>
  <div class="countdown">
    <span id="nextEventName">â€”</span>
    <span class="box" id="cdHours">00</span>:<span class="box" id="cdMinutes">00</span>:<span class="box" id="cdSeconds">00</span>
  </div>
</div>
</header>

<div class="grid">
  <div>
    <div class="card fadeIn delay1">
      <h2 data-i18n="majorAlliance">Major Alliance</h2>
      <div class="alliances-list">
        <div class="alliance kor">ğŸŸ¦ VLN</div>
        <div class="alliance grd">ğŸŸ© GRD</div>
        <div class="alliance bee">ğŸŸ¨ BEE</div>
        <div class="alliance tur">ğŸŸ¥ TUR</div>
      </div>
      <p class="caption" data-i18n="napCaption">NAP based on SVS Prep Contribution. Shared castle/forts + 20% fortress buff rewards.</p>
      <div class="actions">
       <a class="btn neon" href="https://discord.gg/qrcEman8" target="_blank" data-i18n="joinDiscord">ğŸ’¬ Join Discord</a>
       <a class="btn" href="https://docs.google.com/forms/d/e/1FAIpQLScjYq6pLm8E2L5OLPgkGcsxk7Bxj1WlR2aC24lfJs83KOkLQw/viewform?usp=header" target="_blank" data-i18n="registerSVS">ğŸ“‹ Daftar SVS</a>
      </div>
    </div>
    <div class="card fadeIn delay2" style="margin-top:12px;">
      <h2 data-i18n="shortInstructions">Short Instructions</h2>
      <ul style="padding-left:18px;color:var(--muted);margin:6px 0 0 0">
        <li data-i18n-html="instUtc">All times <strong>UTC</strong>.</li>
        <li data-i18n="instBT">ğŸ» = Bear Trap (BT)</li>
        <li data-i18n="instCJ">ğŸ¤  = Crazy Joe (CJ)</li>
        <li data-i18n="instDiscord">Use Discord for SVS coordination</li>
      </ul>
    </div>
  </div>

  <div>
    <div class="card fadeIn delay1">
      <h2 data-i18n="scheduleTitle">Schedule Event (UTC)</h2>
<button class="accordion" data-target="kor-panel">
  <div class="left"><span class="alias kor">VLN</span><div class="alias kor" style="margin-left:6px"><span data-i18n="rolePrimary">â€” primary</span></div></div><div class="chev">â–¸</div></button>
      <div id="kor-panel" class="panel"><div class="event-row"><div class="event-name"><span data-i18n="evBearTrap">ğŸ» Bear Trap</span></div><div class="event-time">12:00 & 13:30</div></div>
<div class="event-row"><div class="event-name"><span data-i18n="evFoundry">ğŸ­ Foundry</span></div><div class="event-time">12:00 & 14:00</div></div>
<div class="event-row"><div class="event-name"><span data-i18n="evCanyon">ğŸï¸ Canyon</span></div><div class="event-time">12:00 & 14:00</div></div>
<div class="event-row"><div class="event-name"><span data-i18n="evCrazyJoe">ğŸ¤  Crazy Joe</span></div><div class="event-time">12:00</div></div></div>
<button class="accordion" data-target="grd-panel">
  <div class="left"><span class="alias grd">GRD</span><div class="alias grd" style="margin-left:6px"><span data-i18n="roleSupport">â€” support</span></div></div><div class="chev">â–¸</div></button>
      <div id="grd-panel" class="panel">
        <div class="event-row"><div class="event-name"><span data-i18n="evBearTrap">ğŸ» Bear Trap</span></div><div class="event-time">14:00 & 16:00</div></div>
<div class="event-row"><div class="event-name"><span data-i18n="evFoundry">ğŸ­ Foundry</span></div><div class="event-time">12:00 & 14:00</div></div>
<div class="event-row"><div class="event-name"><span data-i18n="evCanyon">ğŸï¸ Canyon</span></div><div class="event-time">12:00 & 14:00</div></div>
<div class="event-row"><div class="event-name"><span data-i18n="evCrazyJoe">ğŸ¤  Crazy Joe</span></div><div class="event-time">13:00 & 14:00</div></div></div>
<button class="accordion" data-target="bee-panel">
  <div class="left"><span class="alias bee">BEE</span><div class="alias bee" style="margin-left:6px"><span data-i18n="roleFrontline">â€” frontline</span></div></div><div class="chev">â–¸</div></button>
      <div id="bee-panel" class="panel"><div class="event-row"><div class="event-name"><span data-i18n="evBearTrap">ğŸ» Bear Trap</span></div><div class="event-time">17:00 & 19:00</div></div>
<div class="event-row"><div class="event-name"><span data-i18n="evFoundry">ğŸ­ Foundry</span></div><div class="event-time">14:00 & 19:00</div></div>
<div class="event-row"><div class="event-name"><span data-i18n="evCanyon">ğŸï¸ Canyon</span></div><div class="event-time">12:00 & 19:00</div></div>
<div class="event-row"><div class="event-name"><span data-i18n="evCrazyJoe">ğŸ¤  Crazy Joe</span></div><div class="event-time">16:40 & 17:40</div></div></div>
<button class="accordion" data-target="tur-panel">
  <div class="left"><span class="alias tur">TUR</span><div class="alias tur" style="margin-left:6px"><span data-i18n="roleNight">â€” night ops</span></div></div><div class="chev">â–¸</div></button>
      <div id="tur-panel" class="panel"><div class="event-row"><div class="event-name"><span data-i18n="evBearTrap">ğŸ» Bear Trap</span></div><div class="event-time">13:30 & 19:00</div></div>
<div class="event-row"><div class="event-name"><span data-i18n="evFoundry">ğŸ­ Foundry</span></div><div class="event-time">14:00 & 19:00</div></div>
<div class="event-row"><div class="event-name"><span data-i18n="evCanyon">ğŸï¸ Canyon</span></div><div class="event-time">19:00 & 21:00</div></div>
<div class="event-row"><div class="event-name"><span data-i18n="evCrazyJoe">ğŸ¤  Crazy Joe</span></div><div class="event-time">19:00</div></div></div>
      <p class="caption" data-i18n-html="accordionHint">Click on the alliance name to expand/collapse details. All times are <strong>UTC</strong>.</p>
    </div>
    <div class="card fadeIn delay4" style="margin-top:12px;"><h2 style="color:#fff; margin-bottom:8px;" data-i18n="calcTitle">ğŸ§® Points Calculator SVS</h2>
<p style="color:var(--muted); font-size:13px; margin-top:0; margin-bottom:12px;" data-i18n="calcDesc">If you want to calculate how many points you can collect from the materials you have saved, please visit this website:</p>
<a class="btn neon" href="https://wostools.net/svs-calculator" target="_blank" style="font-weight:700;" data-i18n="calcBtn">ğŸ–±ï¸Visit Calculator SVS</a>
    </div>
  </div>
</div>
<footer style="margin-top:16px;text-align:center;color:var(--muted);font-size:13px">Â© 2025 STATE 1931 â€¢ By Mr.jhon</footer>
</div>

<div class="gift-widget-container" id="giftContainer">
    <div class="gift-box" id="box" onclick="toggleKado()">
        <div class="lid"><div class="bow"></div></div>
        <div class="letter">
            <h2 data-i18n="valTitle">Selamat Valentine!</h2>
            <p id="message"></p>
        </div>
    </div>
</div>
<script>
/* ===== I18N & CORE SCRIPTS ===== */
window.currentLang = 'en'; 
const i18n = {
  en: {
    subtitle: "Whiteout Survival â€” info&schedule (UTC)", nextLabel: "Next event", majorAlliance: "Major Alliance", napCaption: "NAP based on SVS Prep Contribution. Shared castle/forts + 20% fortress buff rewards.", joinDiscord: "ğŸ’¬ Join Discord", registerSVS: "ğŸ“‹ Register SVS", shortInstructions: "Short Instructions", instUtc: "All times <strong>UTC</strong>.", instBT: "ğŸ» = Bear Trap (BT)", instCJ: "ğŸ¤  = Crazy Joe (CJ)", instDiscord: "Use Discord for SVS coordination", scheduleTitle: "Schedule Event (UTC)", rolePrimary: "â€” primary", roleSupport: "â€” support", roleFrontline: "â€” frontline", roleNight: "â€” night ops", evBearTrap: "ğŸ» Bear Trap", evFoundry: "ğŸ­ Foundry", evCanyon: "ğŸï¸ Canyon", evCrazyJoe: "ğŸ¤  Crazy Joe", accordionHint: "Click on the alliance name to expand/collapse details. All times are <strong>UTC</strong>.", calcTitle: "ğŸ§® Points Calculator SVS", calcDesc: "If you want to calculate how many points you can collect from the materials you have saved, please visit this website:", calcBtn: "ğŸ–±ï¸Visit Calculator SVS",
    valTitle: "Happy Valentine!",
    valMessage: "Hey you... Thank you for being part of my story. May your day be as sweet as chocolate and as beautiful as flowers. Happy Valentine's Day! ğŸŒ¹"
  },
  id: {
    subtitle: "Whiteout Survival â€” info & jadwal (UTC)", nextLabel: "Event berikutnya", majorAlliance: "Aliansi Utama", napCaption: "NAP berdasarkan kontribusi persiapan SVS. Kastil/fort berbagi + hadiah buff benteng 20%.", joinDiscord: "ğŸ’¬ Gabung Discord", registerSVS: "ğŸ“‹ Daftar SVS", shortInstructions: "Instruksi Singkat", instUtc: "Semua waktu <strong>UTC</strong>.", instBT: "ğŸ» = Bear Trap (BT)", instCJ: "ğŸ¤  = Crazy Joe (CJ)", instDiscord: "Gunakan Discord untuk koordinasi SVS", scheduleTitle: "Jadwal Event (UTC)", rolePrimary: "â€” utama", roleSupport: "â€” dukungan", roleFrontline: "â€” garis depan", roleNight: "â€” operasi malam", evBearTrap: "ğŸ» Bear Trap", evFoundry: "ğŸ­ Foundry", evCanyon: "ğŸï¸ Canyon", evCrazyJoe: "ğŸ¤  Crazy Joe", accordionHint: "Klik nama aliansi untuk expand/collapse detail. Semua waktu dalam <strong>UTC</strong>.", calcTitle: "ğŸ§® Kalkulator Poin SVS", calcDesc: "Kalau mau hitung poin dari material yang sudah disimpan, kunjungi situs ini:", calcBtn: "ğŸ–±ï¸Kunjungi Kalkulator SVS",
    valTitle: "Selamat Valentine!",
    valMessage: "Hai kamu... Terima kasih sudah menjadi bagian cerita di hidupku. Semoga harimu semanis coklat dan seindah bunga. Happy Valentine's Day! ğŸŒ¹"
  },
  ko: {
    subtitle: "í™”ì´íŠ¸ì•„ì›ƒ ì„œë°”ì´ë²Œ â€” ì •ë³´ & ì¼ì • (UTC)", nextLabel: "ë‹¤ìŒ ì´ë²¤íŠ¸", majorAlliance: "ì£¼ìš” ë™ë§¹", napCaption: "SVS ì¤€ë¹„ ê¸°ì—¬ë„ ê¸°ì¤€ NAP. ì„±/ìš”ìƒˆ ê³µìœ  + ìš”ìƒˆ ë²„í”„ ë³´ìƒ 20%.", joinDiscord: "ğŸ’¬ ë””ìŠ¤ì½”ë“œ ì°¸ì—¬", registerSVS: "ğŸ“‹ SVS ë“±ë¡", shortInstructions: "ê°„ë‹¨í•œ ì§€ì¹¨", instUtc: "ëª¨ë“  ì‹œê°„ì€ <strong>UTC</strong> ê¸°ì¤€ì…ë‹ˆë‹¤.", instBT: "ğŸ» = ë² ì–´ íŠ¸ë© (BT)", instCJ: "ğŸ¤  = í¬ë ˆì´ì§€ ì¡° (CJ)", instDiscord: "SVS ì¡°ìœ¨ì€ ë””ìŠ¤ì½”ë“œë¥¼ ì‚¬ìš©í•˜ì„¸ìš”", scheduleTitle: "ì´ë²¤íŠ¸ ì¼ì • (UTC)", rolePrimary: "â€” ì£¼ë ¥", roleSupport: "â€” ì§€ì›", roleFrontline: "â€” ì „ì„ ", roleNight: "â€” ì•¼ê°„ ì‘ì „", evBearTrap: "ğŸ» ë² ì–´ íŠ¸ë©", evFoundry: "ğŸ­ ì£¼ì¡°ì†Œ", evCanyon: "ğŸï¸ í˜‘ê³¡", evCrazyJoe: "ğŸ¤  í¬ë ˆì´ì§€ ì¡°", accordionHint: "ë™ë§¹ ì´ë¦„ì„ í´ë¦­í•˜ì—¬ ìì„¸íˆ ë³´ê¸°/ì ‘ê¸°. ëª¨ë“  ì‹œê°„ì€ <strong>UTC</strong>ì…ë‹ˆë‹¤.", calcTitle: "ğŸ§® SVS í¬ì¸íŠ¸ ê³„ì‚°ê¸°", calcDesc: "ì €ì¥í•´ë‘” ì¬ë£Œë¡œ ì–»ì„ í¬ì¸íŠ¸ë¥¼ ê³„ì‚°í•˜ë ¤ë©´ ì•„ë˜ ì›¹ì‚¬ì´íŠ¸ë¥¼ ë°©ë¬¸í•˜ì„¸ìš”:", calcBtn: "ğŸ–±ï¸ SVS ê³„ì‚°ê¸° ë°©ë¬¸",
    valTitle: "í•´í”¼ ë°œë Œíƒ€ì¸ë°ì´!",
    valMessage: "ê·¸ëŒ€ì—ê²Œ... ì œ ì‚¶ì˜ ì´ì•¼ê¸°ì˜ ì¼ë¶€ê°€ ë˜ì–´ ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤. ì´ˆì½œë¦¿ì²˜ëŸ¼ ë‹¬ì½¤í•˜ê³  ê½ƒì²˜ëŸ¼ ì•„ë¦„ë‹¤ìš´ í•˜ë£¨ ë˜ì„¸ìš”. í•´í”¼ ë°œë Œíƒ€ì¸ë°ì´! ğŸŒ¹"
  }
};
function applyTranslations(lang){
  const dict = i18n[lang] || i18n.en;
  document.querySelectorAll('[data-i18n]').forEach(el=>{ const key = el.getAttribute('data-i18n'); if(dict[key] != null) el.innerText = dict[key]; });
  document.querySelectorAll('[data-i18n-html]').forEach(el=>{ const key = el.getAttribute('data-i18n-html'); if(dict[key] != null) el.innerHTML = dict[key]; });
  document.documentElement.setAttribute('lang', lang);
}
window.addEventListener('DOMContentLoaded', ()=>{
  document.querySelectorAll('[data-lang]').forEach(btn=>{ btn.addEventListener('click', ()=>{ currentLang = btn.getAttribute('data-lang'); applyTranslations(currentLang); if(typeof updateCountdown === 'function') updateCountdown(); }); });
  applyTranslations(currentLang);
});

/* Snow & Animation */
(() => {
  const canvas=document.getElementById('snow-canvas'); const ctx=canvas.getContext('2d');
  let w=canvas.width=innerWidth, h=canvas.height=innerHeight;
  const flakes=[]; const num=Math.floor((w*h)/50000);
  for(let i=0;i<num;i++){ flakes.push({x:Math.random()*w, y:Math.random()*h, r:(Math.random()*2.5)+0.8, d:Math.random()*1.5, s:(Math.random()*0.6)+0.2}); }
  function resize(){ w=canvas.width=innerWidth; h=canvas.height=innerHeight; }
  addEventListener('resize', resize);
  function draw(){ ctx.clearRect(0,0,w,h); ctx.fillStyle='rgba(255,255,255,0.85)'; flakes.forEach((f,i)=>{ ctx.beginPath(); ctx.arc(f.x,f.y,f.r,0,Math.PI*2); ctx.fill(); f.y+=f.s+Math.sin(f.d+i)*0.3; f.x+=Math.cos(f.d+i)*0.2; if(f.y>h+10) f.y=-5,f.x=Math.random()*w; if(f.x> w+10) f.x=-5; if(f.x< -10) f.x=w+5; }); requestAnimationFrame(draw);}
  draw();
})();
document.querySelectorAll('.accordion').forEach(btn=>{
  btn.addEventListener('click',()=>{ const target=document.getElementById(btn.dataset.target); const chev=btn.querySelector('.chev'); if(!target) return; const opened=target.style.display==='block'; document.querySelectorAll('.panel').forEach(p=>{ p.style.display='none'; p.previousElementSibling.querySelector('.chev').style.transform='rotate(0deg)'; }); if(!opened){ target.style.display='block'; chev.style.transform='rotate(90deg)'; } });
});

/* Countdown */
const schedule=[
  {alli:'VLN',events:[{name:'Bear Trap',times:['12:00','13:30']},{name:'Foundry',times:['12:00','14:00']},{name:'Canyon',times:['12:00','14:00']},{name:'Crazy Joe',times:['12:00']}]},
  {alli:'GRD',events:[{name:'Bear Trap',times:['14:00','16:00']},{name:'Foundry',times:['12:00','14:00']},{name:'Canyon',times:['12:00','14:00']},{name:'Crazy Joe',times:['13:00','14:00']}]},
  {alli:'BEE',events:[{name:'Bear Trap',times:['17:00','19:00']},{name:'Foundry',times:['14:00','19:00']},{name:'Canyon',times:['12:00','19:00']},{name:'Crazy Joe',times:['16:40','17:40']}]},
  {alli:'TUR',events:[{name:'Bear Trap',times:['13:30','19:00']},{name:'Foundry',times:['14:00','19:00']},{name:'Canyon',times:['19:00','21:00']},{name:'Crazy Joe',times:['19:00']}]}
];
function parseUtcTimeToDate(t,base){ const [hh,mm]=t.split(':').map(x=>parseInt(x,10)); return new Date(Date.UTC(base.getUTCFullYear(),base.getUTCMonth(),base.getUTCDate(),hh||0,mm||0,0)); }
function getNextEvent(){
  const now=new Date(),todayUTC=new Date(Date.UTC(now.getUTCFullYear(),now.getUTCMonth(),now.getUTCDate())); let c=[];
  schedule.forEach(s=>s.events.forEach(ev=>ev.times.forEach(t=>{ if(!t || t.toLowerCase()==='null') return; let dt=parseUtcTimeToDate(t,todayUTC); if(dt.getTime()<=now.getTime()) dt=new Date(dt.getTime()+86400000); c.push({alli:s.alli,name:ev.name,timeStr:t,datetime:dt}); })));
  if(c.length===0) return null; c.sort((a,b)=>a.datetime-b.datetime); return c[0];
}
function updateCountdown(){
  const next=getNextEvent();
  if(!next){ document.getElementById('nextEventName').innerText='â€”'; document.getElementById('cdHours').innerText='00'; document.getElementById('cdMinutes').innerText='00'; document.getElementById('cdSeconds').innerText='00'; return; }
  document.getElementById('nextEventName').innerText=`${next.alli} â€¢ ${next.name}`;
  function tick(){
    const now=new Date(),diff=Math.max(0,Math.floor((next.datetime.getTime()-now.getTime())/1000));
    const hrs=Math.floor(diff/3600),mins=Math.floor((diff%3600)/60),secs=diff%60;
    document.getElementById('cdHours').innerText=String(hrs).padStart(2,'0');
    document.getElementById('cdMinutes').innerText=String(mins).padStart(2,'0');
    document.getElementById('cdSeconds').innerText=String(secs).padStart(2,'0');
    if(diff<=0){ setTimeout(updateCountdown,1200); }
  } tick(); if(window._cdInterval) clearInterval(window._cdInterval); window._cdInterval=setInterval(tick,1000);
}
updateCountdown();
document.getElementById('kor-panel').style.display='block'; document.querySelectorAll('.accordion')[0].querySelector('.chev').style.transform='rotate(90deg)';

/* ===== LOGIKA KADO, MUSIK & KEMBANG API HATI ===== */
let i_kado = 0; let speed_kado = 50; let typingTimer;
const msgElement = document.getElementById("message");
const box = document.getElementById("box");
const containerWidget = document.getElementById("giftContainer");

// 1. SETUP MUSIK
const musicUrl = "lagu.mp3"; 
const bgMusic = new Audio(musicUrl);
bgMusic.loop = true; 

// 2. KEMBANG API HATI
function playHeartConfetti() {
    var duration = 3000;
    var animationEnd = Date.now() + duration;
    var defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 10005 };
    function randomInRange(min, max) { return Math.random() * (max - min) + min; }
    var interval = setInterval(function() {
        var timeLeft = animationEnd - Date.now();
        if (timeLeft <= 0) { return clearInterval(interval); }
        var particleCount = 50 * (timeLeft / duration);
        confetti(Object.assign({}, defaults, { 
            particleCount, origin: { x: randomInRange(0.1, 0.3), y: Math.random() - 0.2 },
            shapes: ['heart'], colors: ['#FFC0CB', '#FF0000', '#D32F2F'] 
        }));
        confetti(Object.assign({}, defaults, { 
            particleCount, origin: { x: randomInRange(0.7, 0.9), y: Math.random() - 0.2 },
            shapes: ['heart'], colors: ['#FFC0CB', '#FF0000', '#D32F2F'] 
        }));
    }, 250);
}

function toggleKado() {
    if (box.classList.contains("open")) {
        // Tutup
        box.classList.remove("open"); 
        containerWidget.classList.remove("active");
        bgMusic.pause(); bgMusic.currentTime = 0;
        clearTimeout(typingTimer); i_kado = 0; msgElement.innerHTML = ""; 
    } else {
        // Buka
        containerWidget.classList.add("active");
        bgMusic.play().catch(error => console.log("User interaction needed for audio"));
        setTimeout(() => { 
            box.classList.add("open"); 
            setTimeout(playHeartConfetti, 300); 
            setTimeout(typeWriterKado, 800); 
        }, 500);
    }
}
function typeWriterKado() {
    const currentMsg = i18n[currentLang] && i18n[currentLang].valMessage ? i18n[currentLang].valMessage : i18n['en'].valMessage;
    if (box.classList.contains("open") && i_kado < currentMsg.length) {
        msgElement.innerHTML += currentMsg.charAt(i_kado); i_kado++; typingTimer = setTimeout(typeWriterKado, speed_kado);
    }
}
</script>
</body>
</html>
